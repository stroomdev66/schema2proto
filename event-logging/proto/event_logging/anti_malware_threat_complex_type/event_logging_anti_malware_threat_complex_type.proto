// event_logging_anti_malware_threat_complex_type.proto at 0:0
syntax = "proto3";
package event_logging.anti_malware_threat_complex_type;

import "event_logging/multi_object_complex_type/event_logging_multi_object_complex_type.proto";
import "event_logging/software_complex_type/event_logging_software_complex_type.proto";
import "event_logging/threat_category_simple_type/event_logging_threat_category_simple_type.proto";
import "validate/validate.proto";

// Type that describes a threat identified by an anti-malware scanner.
message AntiMalwareThreatComplexType {
  // Describes the anti-malware product used.
  event_logging.software_complex_type.SoftwareComplexType product = 1;
  // Describes the anti-malware signature used.
  SignatureType signature = 2;
  // Describes the threat if one has been found.
  ThreatType threat = 3;
  // Describes the infected item if one has been found.
  event_logging.multi_object_complex_type.MultiObjectComplexType infected = 4;

  // Describes the anti-malware signature used.
  message SignatureType {
    // The version of the signature.
    string version = 1;
    // When the signature was last updated.
    uint64 updated = 2;
  }
  // Describes the threat if one has been found.
  message ThreatType {
    // The category of the threat, e.g. Worm, Virus, etc.
    event_logging.threat_category_simple_type.ThreatCategorySimpleType category = 1 [
      (validate.rules).message.required = true
    ];
    // The name of the threat, e.g. a virus name.
    string name = 2 [
      (validate.rules).message.required = true
    ];
  }
}
